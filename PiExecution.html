<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Pi-Calculus</title>
	<script src="PiCalculus.js" type="text/javascript"></script>
</head>
<body>
	<canvas id="myCanvas" width="815" height="400" style="border:1px solid black;">
		Your browser does not support the canvas element.
	</canvas>
	<script>
		// Get the URL parameters **************************************************
		startNode = getUrlVars()["start"];
		main_document=getUrlVars()["main_document"];
		picode = decodeURIComponent(getUrlVars()["picode"]); // get picode
		var picode_array = picode.split('\n'); // split it up into lines

		// Delete unused lines ****************************************************
		for(var i=0;i<picode_array.length;i++){
			if (picode_array[i].length<=2){
				picode_array.splice(i, i); // delete element without leaving a hole
			}
		}

		// Check that there are only 6 lines **************************************
		if (picode_array.length>6){
			alert("ERROR too many lines only 6 are allowed!");
			window.history.back();
		}

		// Fill up process_array array with submitted objects  *******************
		for(var i=0;i<picode_array.length;i++){
			var line_equal_array = picode_array[i].split('=');
			var tempObj=new Process(line_equal_array[0],line_equal_array[1],-1,-1);
			process_array.push(tempObj); // add the current process to the process array
		}

		// CANVAS *********************************************************
		var canvas = document.getElementById("myCanvas");
		var ctx = canvas.getContext("2d");

		ctx.font = "30px Arial";
		ctx.fillStyle = '#000000';

		var headline="";
		for(var i=process_array.length-1;i>=0;--i){
			headline=headline+process_array[i].process+"->";
		}
		headline=headline.substr(0, headline.length-2);
		ctx.strokeText(headline, 5, 30);

		var a=100;
		var b=55;
		for(var i=process_array.length-1;i>=0;--i){
			if (process_array[i].process==startNode){
				drawUseCase(ctx, 5, 40);
				process_array[i].x_coord=5;
				process_array[i].y_coord=40
			}else{
				drawBoxWithTextAndSwimLane(ctx, a, b, process_array[i].process);
				process_array[i].x_coord=a;
				process_array[i].y_coord=b;
				a+=150;
			}
		}
	</script>
	<p>
		<hr>
		<b>Original Version:</b><br>
		<script>
			// Print out the original version
			for(var i=0;i<picode_array.length;i++){
				document.writeln(picode_array[i]+"<br>");
			}
		</script>
		<hr>
		<b>Parsed Version:</b><br>
		<script>
			for(var i=0;i<process_array.length;i++){
				parsingALine(process_array[i]);
			}
		</script>
		<hr>
	</p>
	<button onclick="goBack()">Go Back</button>
</body>
</html>